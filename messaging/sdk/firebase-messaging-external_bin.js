(function() {var f=function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]},g="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},h="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&
null!=global?global:this,k=function(a,b){if(b){var c=h;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&g(c,a,{configurable:!0,writable:!0,value:b})}};k("Array.prototype.findIndex",function(a){return a?a:function(a,c){a:{var b=this;b instanceof String&&(b=String(b));for(var e=b.length,l=0;l<e;l++)if(a.call(c,b[l],l,b)){a=l;break a}a=-1}return a}});
k("Object.assign",function(a){return a?a:function(a,c){for(var b=1;b<arguments.length;b++){var e=arguments[b];if(e)for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&(a[l]=e[l])}return a}});
var m=this,n=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},q=function(a,b){function c(){}c.prototype=b.prototype;a.da=b.prototype;a.prototype=new c;a.ba=function(a,c,l){for(var e=Array(arguments.length-2),d=2;d<arguments.length;d++)e[d-2]=arguments[d];return b.prototype[c].apply(a,e)}};var r={f:"only-available-in-window",v:"only-available-in-sw",N:"should-be-overriden",g:"bad-sender-id",L:"permission-default",K:"permission-blocked",S:"unsupported-browser",G:"notifications-blocked",C:"failed-serviceworker-registration",h:"sw-registration-expected",D:"get-subscription-failed",Y:"invalid-saved-token",l:"sw-reg-redundant",O:"token-subscribe-failed",P:"token-subscribe-no-token",T:"use-sw-before-get-token",F:"invalid-delete-token",B:"delete-token-not-found",w:"bg-handler-function-expected",
J:"no-window-client-to-msg",R:"unable-to-resubscribe",I:"no-fcm-token-for-resubscribe"},t={},u=(t[r.f]="This method is available in a Window context.",t[r.v]="This method is available in a service worker context.",t[r.N]="This method should be overriden by extended classes.",t[r.g]="When calling firebase.initializeApp please ensure 'messagingSenderId' is set as a string value.",t[r.L]="The required permissions were not granted and dismissed instead.",t[r.K]="The required permissions were not granted and blocked instead.",
t[r.S]="This browser doesn't the API's required to use the firebase SDK.",t[r.G]="Notifications have been blocked.",t[r.C]="We are unable to register the default service worker. {$browserErrorMessage}",t[r.h]="A service worker registration was the expected input.",t[r.D]="There was an error when trying to get any existing Push Subscriptions.",t[r.Y]="Unable to parse the saved token.",t[r.l]="The service worker being used for push was made redundant.",t[r.O]="A problem occured while subscribing the user to FCM: {$message}",
t[r.P]="FCM returned no token when subscribing the user to push.",t[r.T]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",t[r.F]="You must pass in a valid token in deleteToken().",t[r.B]="The deletion attempt for token could not be performed as the token was not found.",t[r.w]="The input to setBackgroundMessageHandler() must be a function.",t[r.J]="An attempt was made to message a non-existant window client.",t[r.R]="There was an error while resubscribing the FCM token for push messaging. {$message}",
t[r.I]="Could not find an FCM token for service worker with scope '{$scope}' so could not resubscribe.",t);var w={userVisibleOnly:!0,applicationServerKey:new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110])};var x={m:"firebase-messaging-msg-type",A:"firebase-messaging-msg-data"},y={M:"push-msg-received",H:"notification-clicked"},z=function(a,b){var c={};return c[x.m]=a,c[x.A]=b,c};var A=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,A);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))};q(A,Error);var B=function(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")};var C=function(a,b){b.unshift(a);A.call(this,B.apply(null,b));b.shift()};q(C,A);var E=function(a,b,c){if(!a){var d="Assertion failed";if(b)var d=d+(": "+b),e=Array.prototype.slice.call(arguments,2);throw new C(""+d,e||[]);}};var F=null;var G=function(a){a=new Uint8Array(a);var b=n(a);E("array"==b||"object"==b&&"number"==typeof a.length,"encodeByteArray takes an array as a parameter");if(!F)for(F={},b=0;65>b;b++)F[b]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b);for(var b=F,c=[],d=0;d<a.length;d+=3){var e=a[d],l=d+1<a.length,p=l?a[d+1]:0,D=d+2<a.length,v=D?a[d+2]:0,Q=e>>2,e=(e&3)<<4|p>>4,p=(p&15)<<2|v>>6,v=v&63;D||(v=64,l||(p=64));c.push(b[Q],b[e],b[p],b[v])}return c.join("").replace(/\+/g,"-").replace(/\//g,
"_").replace(/=+$/,"")};var H=new firebase.INTERNAL.ErrorFactory("messaging","Messaging",u),I=function(){this.a=null},J=function(a){if(a.a)return a.a;a.a=new Promise(function(a,c){var b=m.indexedDB.open("fcm_token_details_db",1);b.onerror=function(a){c(a.target.error)};b.onsuccess=function(b){a(b.target.result)};b.onupgradeneeded=function(a){a=a.target.result.createObjectStore("fcm_token_object_Store",{keyPath:"fcmToken"});a.createIndex("fcmSenderId","fcmSenderId",{unique:!1});a.createIndex("swScope","swScope",{unique:!0})}});
return a.a},K=function(a){a.a?a.a.then(function(b){b.close();a.a=null}):Promise.resolve()},L=function(a,b){return J(a).then(function(a){return new Promise(function(c,e){var d=a.transaction(["fcm_token_object_Store"]).objectStore("fcm_token_object_Store").get(b);d.onerror=function(a){e(a.target.error)};d.onsuccess=function(a){c(a.target.result)}})})},N=function(a){var b=M.registration.scope;return J(a).then(function(a){return new Promise(function(c,e){var d=a.transaction(["fcm_token_object_Store"]).objectStore("fcm_token_object_Store").index("swScope").get(b);
d.onerror=function(a){e(a.target.error)};d.onsuccess=function(a){c(a.target.result)}})})},O=function(a,b){return J(a).then(function(a){return new Promise(function(c,e){var d=[],p=a.transaction(["fcm_token_object_Store"]).objectStore("fcm_token_object_Store").index("fcmSenderId").openKeyCursor();p.onerror=function(a){e(a.target.error)};p.onsuccess=function(a){(a=a.target.result)?(a.key===b&&d.push(a.primaryKey),a.continue()):c(d)}})})},P=function(a){var b=a.installing||a.waiting||a.active;return new Promise(function(c,
d){if("activated"===b.state)c(a);else if("redundant"===b.state)d(H.create(r.l));else{var e=function(){if("activated"===b.state)c(a);else if("redundant"===b.state)d(H.create(r.l));else return;b.removeEventListener("statechange",e)};b.addEventListener("statechange",e)}})},R=function(a,b){var c=G(b.getKey("p256dh")),d=G(b.getKey("auth"));a="authorized_entity="+a+"&"+("endpoint="+b.endpoint+"&")+("encryption_key="+c+"&")+("encryption_auth="+d);b=new Headers;b.append("Content-Type","application/x-www-form-urlencoded");
return fetch("https://fcm.googleapis.com/fcm/connect/subscribe",{method:"POST",headers:b,body:a}).then(function(a){return a.json()}).then(function(a){if(a.error)throw H.create(r.O,{message:a.error.message});if(!a.token)throw H.create(r.P);return a.token})},S=function(a,b,c,d,e){var l={swScope:c.scope,endpoint:d.endpoint,auth:G(d.getKey("auth")),p256dh:G(d.getKey("p256dh")),fcmToken:e,fcmSenderId:b};J(a).then(function(a){return new Promise(function(b,c){var d=a.transaction(["fcm_token_object_Store"],
"readwrite").objectStore("fcm_token_object_Store").add(l);d.onerror=function(a){c(a.target.error)};d.onsuccess=function(){b()}})})};
I.prototype.W=function(a,b){var c=this;return b instanceof ServiceWorkerRegistration?"string"!==typeof a||0===a.length?Promise.reject(H.create(r.g)):O(this,a).then(function(d){if(0!==d.length)return Promise.all(d.map(function(a){return L(c,a)})).then(function(c){var d=c.findIndex(function(c){return b.scope===c.swScope&&a===c.fcmSenderId});if(-1!==d)return c[d]})}).then(function(a){if(a)return b.pushManager.getSubscription().catch(function(){throw H.create(r.D);}).then(function(b){var c;if(c=b)c=b.endpoint===
a.endpoint&&G(b.getKey("auth"))===a.auth&&G(b.getKey("p256dh"))===a.p256dh;if(c)return a.fcmToken})}):Promise.reject(H.create(r.h))};I.prototype.getSavedToken=I.prototype.W;
I.prototype.U=function(a,b){var c=this;return"string"!==typeof a||0===a.length?Promise.reject(H.create(r.g)):b instanceof ServiceWorkerRegistration?P(b).then(function(){return b.pushManager.getSubscription()}).then(function(a){return a?a:b.pushManager.subscribe(w)}).then(function(d){return R(a,d).then(function(e){S(c,a,b,d,e);return e})}):Promise.reject(H.create(r.h))};I.prototype.createToken=I.prototype.U;
I.prototype.i=function(a){var b=this;return"string"!==typeof a||0===a.length?Promise.reject(H.create(r.F)):L(this,a).then(function(c){if(!c)throw H.create(r.B);return J(b).then(function(b){return new Promise(function(d,l){var e=b.transaction(["fcm_token_object_Store"],"readwrite").objectStore("fcm_token_object_Store").delete(a);e.onerror=function(a){l(a.target.error)};e.onsuccess=function(){d(c)}})})})};var T=function(a){var b=this;this.a=new firebase.INTERNAL.ErrorFactory("messaging","Messaging",u);if(!a.options.messagingSenderId||"string"!==typeof a.options.messagingSenderId)throw this.a.create(r.g);this.X=a.options.messagingSenderId;this.c=new I;this.app=a;this.INTERNAL={};this.INTERNAL.delete=function(){return b.delete}};
T.prototype.getToken=function(){var a=this,b=Notification.permission;return"granted"!==b?"denied"===b?Promise.reject(this.a.create(r.G)):Promise.resolve(null):this.j().then(function(b){return a.c.W(a.X,b).then(function(c){return c?c:a.c.U(a.X,b)})})};T.prototype.getToken=T.prototype.getToken;T.prototype.i=function(a){var b=this;return this.c.i(a).then(function(){return b.j()}).then(function(a){return a?a.pushManager.getSubscription():null}).then(function(a){if(a)return a.unsubscribe()})};
T.prototype.deleteToken=T.prototype.i;T.prototype.j=function(){throw this.a.create(r.N);};T.prototype.requestPermission=function(){throw this.a.create(r.f);};T.prototype.u=function(){throw this.a.create(r.f);};T.prototype.useServiceWorker=T.prototype.u;T.prototype.onMessage=function(){throw this.a.create(r.f);};T.prototype.onMessage=T.prototype.onMessage;T.prototype.o=function(){throw this.a.create(r.f);};T.prototype.onTokenRefresh=T.prototype.o;T.prototype.s=function(){throw this.a.create(r.v);};
T.prototype.setBackgroundMessageHandler=T.prototype.s;T.prototype.delete=function(){K(this.c)};var M=self,X=function(a){var b=this;T.call(this,a);this.a=new firebase.INTERNAL.ErrorFactory("messaging","Messaging",u);M.addEventListener("push",function(a){return U(b,a)},!1);M.addEventListener("pushsubscriptionchange",function(a){return V(b,a)},!1);M.addEventListener("notificationclick",function(a){return W(b,a)},!1);this.b=null};f(X,T);
var U=function(a,b){var c;try{c=b.data.json()}catch(e){return}var d=aa().then(function(b){if(b){if(c.notification||a.b)return ba(a,c)}else{if((b=c)&&"object"===typeof b.notification){var d=Object.assign({},b.notification),e={};d.data=(e.FCM_MSG=b,e);b=d}else b=void 0;if(b)return M.registration.showNotification(b.title||"",b);if(a.b)return a.b(c)}});b.waitUntil(d)},V=function(a,b){var c=N(a.c).then(function(b){if(!b)throw a.a.create(r.I,{scope:M.registration.scope});return M.registration.pushManager.subscribe(w).then(function(){}).catch(function(c){return a.c.i(b.ca).then(function(){throw a.a.create(r.R,
{message:c});})})});b.waitUntil(c)},W=function(a,b){if(b.notification&&b.notification.data&&b.notification.data.FCM_MSG){b.stopImmediatePropagation();b.notification.close();var c=b.notification.data.FCM_MSG,d=c.notification.click_action;if(d){var e=ca(d).then(function(a){return a?a:M.clients.openWindow(d)}).then(function(b){if(b)return delete c.notification,Y(a,b,z(y.H,c))});b.waitUntil(e)}}};X.prototype.s=function(a){if(a&&"function"!==typeof a)throw this.a.create(r.w);this.b=a};
X.prototype.setBackgroundMessageHandler=X.prototype.s;
var ca=function(a){var b=(new URL(a)).href;return M.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(a){for(var c=null,e=0;e<a.length;e++)if((new URL(a[e].url)).href===b){c=a[e];break}if(c)return c.focus(),c})},Y=function(a,b,c){return new Promise(function(d,e){if(!b)return e(a.a.create(r.J));b.postMessage(c);d()})},aa=function(){return M.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(a){return a.some(function(a){return"visible"===a.visibilityState})})},
ba=function(a,b){return M.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(c){var d=z(y.M,b);return Promise.all(c.map(function(b){return Y(a,b,d)}))})};X.prototype.j=function(){return Promise.resolve(M.registration)};var Z=function(a){var b=this;T.call(this,a);this.V=null;this.Z=firebase.INTERNAL.createSubscribe(function(a){b.V=a});this.aa=null;this.$=firebase.INTERNAL.createSubscribe(function(a){b.aa=a});da(this)};f(Z,T);Z.prototype.getToken=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")?T.prototype.getToken.call(this):Promise.reject(this.a.create(r.S))};
Z.prototype.getToken=Z.prototype.getToken;Z.prototype.requestPermission=function(){var a=this;return"granted"===Notification.permission?Promise.resolve():new Promise(function(b,c){var d=function(d){return"granted"===d?b():"denied"===d?c(a.a.create(r.K)):c(a.a.create(r.L))},e=Notification.requestPermission(function(a){e||d(a)});e&&e.then(d)})};Z.prototype.requestPermission=Z.prototype.requestPermission;
Z.prototype.u=function(a){if(!(a instanceof ServiceWorkerRegistration))throw this.a.create(r.h);if("undefined"!==typeof this.b)throw this.a.create(r.T);this.b=a};Z.prototype.useServiceWorker=Z.prototype.u;Z.prototype.onMessage=function(a,b,c){return this.Z(a,b,c)};Z.prototype.onMessage=Z.prototype.onMessage;Z.prototype.o=function(a,b,c){return this.$(a,b,c)};Z.prototype.onTokenRefresh=Z.prototype.o;
Z.prototype.j=function(){var a=this;if(this.b)return Promise.resolve(this.b);this.b=null;return navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"firebase-cloud-messaging-push-scope"}).then(function(b){a.b=b;b.update();return b}).catch(function(b){throw a.a.create(r.C,{browserErrorMessage:b.message});})};
var da=function(a){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(b){if(b.data&&b.data[x.m])switch(b=b.data,b[x.m]){case y.M:case y.H:a.V.next(b[x.A])}},!1)};if(!(firebase&&firebase.INTERNAL&&firebase.INTERNAL.registerService))throw Error("Cannot install Firebase Messaging - be sure to load firebase-app.js first.");firebase.INTERNAL.registerService("messaging",function(a){return self&&"ServiceWorkerGlobalScope"in self?new X(a):new Z(a)},{Messaging:Z});})();
