(function() {for(var f="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)},g="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this,h=["Object","assign"],k=0;k<h.length-1;k++){var l=h[k];l in g||(g[l]={});g=g[l]}
var m=h[h.length-1],n=g[m],p=n?n:function(b,a){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])}return b};p!=n&&null!=p&&f(g,m,{configurable:!0,writable:!0,value:p});
var r=function(b){var a=typeof b;if("object"==a)if(b){if(b instanceof Array)return"array";if(b instanceof Object)return a;var c=Object.prototype.toString.call(b);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof b.length&&"undefined"!=typeof b.splice&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof b.call&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==a&&"undefined"==typeof b.call)return"object";return a},u=function(b,a){function c(){}c.prototype=a.prototype;b.V=a.prototype;b.prototype=new c;b.T=function(b,c,v){for(var e=Array(arguments.length-2),d=2;d<arguments.length;d++)e[d-2]=arguments[d];return a.prototype[c].apply(b,e)}};var w=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110];var x={h:"firebase-messaging-msg-type",l:"firebase-messaging-msg-data"},y={C:"push-msg-received",v:"notification-clicked"},z=function(b,a){var c={};return c[x.h]=b,c[x.l]=a,c};var A={j:"bg-handler-function-expected",w:"no-window-client-to-msg"},B={},C=(B[A.j]="The input to setBackgroundMessageHandler() must be a function.",B[A.w]="An attempt was made to message a non-existant window client.",B);var D={c:"bad-sender-id",B:"permission-default",A:"permission-blocked",G:"unsupported-browser",u:"notifications-blocked",m:"failed-serviceworker-registration",f:"sw-registration-expected",o:"get-subscription-failed",s:"invalid-saved-token",g:"sw-reg-redundant",D:"token-subscribe-failed",F:"token-subscribe-no-token",H:"use-sw-before-get-token"},E={},F=(E[D.c]="When calling firebase.initializeApp please ensure 'messagingSenderId' is set as a string value.",E[D.B]="The required permissions were not granted and dismissed instead.",
E[D.A]="The required permissions were not granted and blocked instead.",E[D.G]="This browser doesn't the API's required to use the firebase SDK.",E[D.u]="Notifications have been blocked.",E[D.m]="We are unable to register the default service worker. {$browserErrorMessage}",E[D.f]="A service worker registration was the expected input.",E[D.o]="There was an error when trying to get any existing Push Subscriptions.",E[D.s]="Unable to parse the saved token.",E[D.g]="The service worker being used for push was made redundant.",
E[D.D]="A problem occured while subscribing the user to FCM: ${message}",E[D.F]="FCM returned no token when subscribing the user to push.",E[D.H]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",E);var G=function(b){if(Error.captureStackTrace)Error.captureStackTrace(this,G);else{var a=Error().stack;a&&(this.stack=a)}b&&(this.message=String(b))};u(G,Error);var H=function(b,a){for(var c=b.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")};var J=self,M=function(){var b=this;this.b=new firebase.INTERNAL.ErrorFactory("messaging","Messaging",C);J.addEventListener("push",function(a){return K(b,a)},!1);J.addEventListener("pushsubscriptionchange",function(){},!1);J.addEventListener("notificationclick",function(a){return L(b,a)},!1);this.a=null},K=function(b,a){var c;try{c=a.data.json()}catch(e){return}var d=N().then(function(a){if(a){if(c.notification||b.a)return O(b,c)}else{if((a=c)&&"object"===typeof a.notification){var d=Object.assign({},
a.notification),e={};d.data=(e.FCM_MSG=a,e);a=d}else a=void 0;if(a)return J.registration.showNotification(a.title||"",a);if(b.a)return b.a(c)}});a.waitUntil(d)},L=function(b,a){if(a.notification&&a.notification.data&&a.notification.data.FCM_MSG){a.notification.close();var c=a.notification.data.FCM_MSG,d=c.notification.click_action;if(d){var e=P(d).then(function(a){return a?a:J.clients.openWindow(d)}).then(function(a){if(a)return delete c.notification,Q(b,a,z(y.v,c))});a.waitUntil(e)}}};
M.prototype.R=function(b){if(b&&"function"!==typeof b)throw this.b.create(A.j);this.a=b};M.prototype.setBackgroundMessageHandler=M.prototype.R;
var P=function(b){var a=(new URL(b)).href;return J.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(b){for(var c=null,e=0;e<b.length;e++)if((new URL(b[e].url)).href===a){c=b[e];break}if(c)return c.focus(),c})},Q=function(b,a,c){return new Promise(function(d,e){if(!a)return e(b.b.create(A.w));a.postMessage(c);d()})},N=function(){return J.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(b){return b.some(function(a){return"visible"===a.visibilityState})})},
O=function(b,a){return J.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(c){var d=z(y.C,a);return Promise.all(c.map(function(a){return Q(b,a,d)}))})};var R=function(b,a){a.unshift(b);G.call(this,H.apply(null,a));a.shift()};u(R,G);var S=function(b,a,c){if(!b){var d="Assertion failed";if(a)var d=d+(": "+a),e=Array.prototype.slice.call(arguments,2);throw new R(""+d,e||[]);}};var T=null;var U=function(b){b=new Uint8Array(b);var a=r(b);S("array"==a||"object"==a&&"number"==typeof b.length,"encodeByteArray takes an array as a parameter");if(!T)for(T={},a=0;65>a;a++)T[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a);for(var a=T,c=[],d=0;d<b.length;d+=3){var e=b[d],v=d+1<b.length,q=v?b[d+1]:0,I=d+2<b.length,t=I?b[d+2]:0,aa=e>>2,e=(e&3)<<4|q>>4,q=(q&15)<<2|t>>6,t=t&63;I||(t=64,v||(q=64));c.push(a[aa],a[e],a[q],a[t])}return c.join("").replace(/\+/g,"-").replace(/\//g,
"_").replace(/=+$/,"")};var V=new firebase.INTERNAL.ErrorFactory("messaging","Messaging",F),W=function(){},ba=function(b){var a=b.installing||b.waiting||b.active;return new Promise(function(c,d){if("activated"===a.state)c(b);else if("redundant"===a.state)d(V.create(D.g));else{var e=function(){if("activated"===a.state)c(b);else if("redundant"===a.state)d(V.create(D.g));else return;a.removeEventListener("statechange",e)};a.addEventListener("statechange",e)}})},ca=function(b,a){var c=U(a.getKey("p256dh")),d=U(a.getKey("auth"));
b="authorized_entity="+b+"&"+("endpoint="+a.endpoint+"&")+("encryption_key="+c+"&")+("encryption_auth="+d);a=new Headers;a.append("Content-Type","application/x-www-form-urlencoded");return fetch("https://jmt17.google.com/dev/fcm/connect/subscribe",{method:"POST",headers:a,body:b}).then(function(a){return a.json()}).then(function(a){if(a.error)throw V.create(D.D,{message:a.error.message});if(!a.token)throw V.create(D.F);return a.token})};
W.prototype.L=function(b,a){return(new Promise(function(c){if(!(a instanceof ServiceWorkerRegistration))throw V.create(D.f);if("string"!==typeof b||0===b.length)throw V.create(D.c);var d=window.localStorage.getItem("fcm_token_details");if(null===d)return c();var e;try{e=JSON.parse(d)}catch(v){throw V.create(D.s);}return a.scope!==e.swScope||b!==e.senderId?c():c(e)})).then(function(b){if(b)return a.pushManager.getSubscription().catch(function(){throw V.create(D.o);}).then(function(a){var c;if(c=a)c=
a.endpoint===b.endpoint&&U(a.getKey("auth"))===b.auth&&U(a.getKey("p256dh"))===b.p256dh;if(c)return b.token})})};W.prototype.getSavedToken=W.prototype.L;
W.prototype.J=function(b,a){return"string"!==typeof b||0===b.length?Promise.reject(V.create(D.c)):a instanceof ServiceWorkerRegistration?ba(a).then(function(){return a.pushManager.getSubscription()}).then(function(b){return b?b:a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:new Uint8Array(w)})}).then(function(c){return ca(b,c).then(function(d){var e={swScope:a.scope,endpoint:c.endpoint,auth:U(c.getKey("auth")),p256dh:U(c.getKey("p256dh")),token:d,senderId:b};window.localStorage.setItem("fcm_token_details",
JSON.stringify(e));return d})}):Promise.reject(V.create(D.f))};W.prototype.createToken=W.prototype.J;W.prototype.i=function(){window.localStorage.removeItem("fcm_token_details");return Promise.resolve()};var X=new W,Y=function(b){var a=this;this.a=new firebase.INTERNAL.ErrorFactory("messaging","Messaging",F);if(!b.options.messagingSenderId||"string"!==typeof b.options.messagingSenderId)throw this.a.create(D.c);this.K=b.options.messagingSenderId;this.I=null;this.M=firebase.INTERNAL.createSubscribe(function(b){a.I=b});this.O=null;this.N=firebase.INTERNAL.createSubscribe(function(b){a.O=b});da(this)};
Y.prototype.requestPermission=function(){var b=this;return"granted"===Notification.permission?Promise.resolve():new Promise(function(a,c){var d=function(d){return"granted"===d?a():"denied"===d?c(b.a.create(D.A)):c(b.a.create(D.B))},e=Notification.requestPermission(function(a){e||d(a)});e&&e.then(d)})};Y.prototype.requestPermission=Y.prototype.requestPermission;
var da=function(b){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(a){if(a.data&&a.data[x.h])switch(a=a.data,a[x.h]){case y.C:case y.v:b.I.next(a[x.l])}},!1)};
Y.prototype.getToken=function(){var b=this;if(!("serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")))return Promise.reject(this.a.create(D.G));var a=Notification.permission;return"granted"!==a?"denied"===a?Promise.reject(this.a.create(D.u)):Promise.resolve(null):Z(this).then(function(a){return X.L(b.K,a).then(function(c){return c?c:X.J(b.K,a)})})};
Y.prototype.getToken=Y.prototype.getToken;Y.prototype.i=function(){var b=this;return X.i().then(function(){return Z(b)}).then(function(a){return a?a.pushManager.getSubscription():null}).then(function(a){if(a)return a.unsubscribe()})};Y.prototype.deleteToken=Y.prototype.i;Y.prototype.S=function(b){if(!(b instanceof ServiceWorkerRegistration))throw this.a.create(D.f);if("undefined"!==typeof this.b)throw this.a.create(D.H);this.b=b};Y.prototype.useServiceWorker=Y.prototype.S;
var Z=function(b){if(b.b)return Promise.resolve(b.b);b.b=null;return navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"firebase-cloud-messaging-push-scope"}).then(function(a){b.b=a;a.update();return a}).catch(function(a){throw b.a.create(D.m,{U:a.message});})};Y.prototype.onMessage=function(b,a,c){return this.M(b,a,c)};Y.prototype.onMessage=Y.prototype.onMessage;Y.prototype.P=function(b,a,c){return this.N(b,a,c)};Y.prototype.onTokenRefresh=Y.prototype.P;if(!(firebase&&firebase.INTERNAL&&firebase.INTERNAL.registerService))throw Error("Cannot install Firebase Messaging - be sure to load firebase-app.js first.");firebase.INTERNAL.registerService("messaging",function(b){return self&&"ServiceWorkerGlobalScope"in self?new M:new Y(b)},{Messaging:Y});})();
